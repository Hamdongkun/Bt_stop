<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <link href="https://fonts.googleapis.com/css?family=Inter&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/css/globals.css" />
  <link rel="stylesheet" href="/css/payment_page.css" />
  <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
  <title>Buttle - ê²°ì œí˜ì´ì§€</title>
</head>
<body>
<div class="box">
  <div class="overlap">
    <!-- ìƒë‹¨ íƒ€ì´í‹€ ì˜ì—­ -->
    <a href="#" class="logo1">Buttle</a>
    <hr class="line1"/>
    <span class="title-text">ì£¼ë¬¸ ê²°ì œ</span>
    <hr class="line2"/>
    <span class="subtitle-text">ë°°ì†¡ ì •ë³´</span>
    <hr class="line3"/>

    <!-- ğŸš€ ë°°ì†¡ ì •ë³´ëŠ” order-summary ë°–ì—ì„œ ì¶œë ¥í•´ì•¼ í•¨! -->
    <div class="form-group">
      <input class="form-input" placeholder="ë°›ëŠ”ì‚¬ëŒ" />

      <div class="postcode-group">
        <input id="postcode" class="form-input" placeholder="ìš°í¸ë²ˆí˜¸" />
        <button type="button" class="find_address-button" onclick="execDaumPostcode()">ì£¼ì†Œ ì°¾ê¸°</button>
      </div>

      <input id="address" class="form-input" placeholder="ê¸°ë³¸ì£¼ì†Œ" />
      <input id="detailAddress" class="form-input" placeholder="ìƒì„¸ ì£¼ì†Œ ë° ê±´ë¬¼ëª…" />
      <input class="form-input" placeholder="íœ´ëŒ€í° ë²ˆí˜¸" />
    </div>

    <!-- ğŸš€ ì£¼ë¬¸ ìƒí’ˆì€ ë³„ë„ ì¹´ë“œë¡œ ë…ë¦½ ì¶œë ¥ -->
    <div class="order-summary">
      <h3 class="order-summary-title">ì£¼ë¬¸ ìƒí’ˆ</h3>
      <div class="order-items">
        <div th:each="item : ${cartItems}" class="order-item">
          <img th:src="@{${item.imageUrl}}" alt="ìƒí’ˆ ì´ë¯¸ì§€" class="order-item-image" />
          <div class="order-item-info">
            <div class="order-item-name" th:text="${item.productName}">ìƒí’ˆëª…</div>
            <div class="order-item-quantity" th:text="'ìˆ˜ëŸ‰: ' + ${item.quantity} + 'ê°œ'">ìˆ˜ëŸ‰</div>
            <div class="order-item-price" th:text="${item.linePrice} + 'ì›'">ê°€ê²©</div>
          </div>
        </div>
      </div>

      <!-- ì´ ê²°ì œ ê¸ˆì•¡ì€ ì£¼ë¬¸ ìƒí’ˆ ì¹´ë“œ ì•ˆ ë§ˆì§€ë§‰ì— ì¶œë ¥ -->
      <div class="order-total">
        <span>ì´ ê²°ì œ ê¸ˆì•¡</span>
        <span class="order-total-price" th:text="${totalPrice} + 'ì›'">ì´ê¸ˆì•¡</span>
      </div>
    </div>

    <!-- ì£¼ë¬¸í•˜ê¸° ë²„íŠ¼ form -->
    <form th:action="@{/processOrder}" method="post" id="orderForm">
      <!-- CSRF í† í° ì¶”ê°€ -->
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

      <!-- ë°°ì†¡ ì •ë³´ hidden input -->
      <input type="hidden" name="receiver" value="" id="receiver-input"/>
      <input type="hidden" name="postcode" id="postcode-input"/>
      <input type="hidden" name="address" id="address-input"/>
      <input type="hidden" name="detailAddress" id="detailAddress-input"/>
      <input type="hidden" name="phone" value="" id="phone-input"/>

      <!-- ì£¼ë¬¸í•˜ê¸° ë²„íŠ¼ (submit ë²„íŠ¼) -->
      <button type="submit" class="payment-rectangle" onclick="updateOrderForm()">
        <div class="payment-text">ì£¼ë¬¸í•˜ê¸°</div>
      </button>
    </form>
  </div>
</div>

<!-- ì£¼ì†Œì°¾ê¸° ìŠ¤í¬ë¦½íŠ¸ -->
<script>
  function execDaumPostcode() {
    new daum.Postcode({
      oncomplete: function(data) {
        document.getElementById('postcode').value = data.zonecode;
        document.getElementById('address').value = data.address;
        document.getElementById('detailAddress').focus();
      }
    }).open();
  }
</script>

<!-- ì£¼ë¬¸ì •ë³´ form ê°’ ì±„ìš°ëŠ” ìŠ¤í¬ë¦½íŠ¸ -->
<script>
  function updateOrderForm() {
    document.getElementById('receiver-input').value = document.querySelector('input[placeholder="ë°›ëŠ”ì‚¬ëŒ"]').value;
    document.getElementById('postcode-input').value = document.getElementById('postcode').value;
    document.getElementById('address-input').value = document.getElementById('address').value;
    document.getElementById('detailAddress-input').value = document.getElementById('detailAddress').value;
    document.getElementById('phone-input').value = document.querySelector('input[placeholder="íœ´ëŒ€í° ë²ˆí˜¸"]').value;
  }
</script>

</body>
</html>
